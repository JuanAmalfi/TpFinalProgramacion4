<div class="libros-layout">

  <!-- HEADER -->
  <div class="lista-header">
    <h2>Libros disponibles</h2>
    <button class="filters-btn" (click)="toggleFiltros()">üß© Filtros</button>
  </div>

  <!-- GRID -->
  <div class="grid-libros">
    @for (libro of filteredLibros(); track libro.id) {
      <div class="card-libro" (click)="verDetalle(libro.id!)">
        <img [src]="libro.portada || 'assets/placeholder.png'" class="portada" />
        <h4>{{ libro.titulo }}</h4>
        <p class="autor">{{ libro.autor }}</p>
        <p class="precio">$ {{ libro.precio }}</p>
        <div class="rating">
    @for (i of [1,2,3,4,5]; track i) {
      <span class="star">
        {{ i <= redondear(libro.promedioCalificacion || 0) ? '‚òÖ' : '‚òÜ' }}
      </span>
    }
  </div>
      </div>
    }
  </div>

  <!-- MODAL FILTROS -->
  @if (filtrosAbiertos()) {
    <div class="filters-backdrop" (click)="toggleFiltros()">
      <div class="filters-modal" (click)="$event.stopPropagation()">

        <div class="modal-header">
          <h3>Filtros</h3>
          <button class="close-modal" (click)="toggleFiltros()">‚úñ</button>
        </div>

        <div class="filtro">
          <label>Autor</label>
          <input type="text" placeholder="Buscar autor..."
                (input)="filtroAutor.set($any($event.target).value)">
        </div>

        <div class="filtro">
          <label>G√©nero</label>
          <select (change)="filtroGenero.set($any($event.target).value)">
            <option value="">Todos</option>
            <option>Ficci√≥n</option>
            <option>No Ficci√≥n</option>
            <option>Ciencia Ficci√≥n</option>
            <option>Fantas√≠a</option>
            <option>Misterio</option>
            <option>Romance</option>
          </select>
        </div>

        <div class="filtro">
          <label>A√±o</label>
          <input type="number" placeholder="Ej: 2021"
                (input)="filtroAnio.set($any($event.target).value || null)">
        </div>

        <div class="filtro">
          <label>Precio</label>
          <div class="precio-range">
            <input type="number" placeholder="M√≠n"
              (input)="filtroPrecioMin.set($any($event.target).value || null)">
            <span>‚Äî</span>
            <input type="number" placeholder="M√°x"
              (input)="filtroPrecioMax.set($any($event.target).value || null)">
          </div>
        </div>

        <div class="filtro checkbox-filtro">
          <label><input type="checkbox"
            (change)="filtroDisponible.set($any($event.target).checked)"> Solo disponibles</label>
        </div>

        <div class="modal-actions">
          <button class="btn-clear" (click)="limpiarFiltros()">Limpiar</button>
          <button class="btn-apply" (click)="toggleFiltros()">Aplicar</button>
        </div>

      </div>
    </div>
  }

</div>
